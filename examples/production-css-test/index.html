<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production CSS Architecture Test - Open Web Inspector</title>
    
    <!-- External cross-origin CDN (simulating real production) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    
    <!-- Main CSS with @import architecture (exactly like production websites) -->
    <link href="styles/main.css" rel="stylesheet">
    
    <meta name="description" content="Testing Open Web Inspector's CSS detection on production-style @import architecture">
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1 class="hero__title">Production CSS Architecture Test</h1>
            <p class="hero__subtitle">Real-world @import + cross-origin stylesheet simulation</p>
            <p class="hero__description">
                This test perfectly replicates the production website architecture where 
                <code>main.css</code> uses <code>@import</code> rules to load component-specific 
                stylesheets, with some cross-origin resources that get blocked by browser security.
            </p>
            
            <div class="test-element interactive highlighted">
                <i class="fas fa-microscope icon-element"></i>
                <strong>Complex Element:</strong> This element has styles from multiple sources:
                <ul>
                    <li>ğŸŒ <strong>Cross-origin @imports:</strong> Google Fonts loaded via main.css</li>
                    <li>ğŸ¨ <strong>External CDN:</strong> Font Awesome (direct link)</li>
                    <li>ğŸ“ <strong>Local @imports:</strong> hero.css, test-elements.css, buttons.css, layout.css</li>
                    <li>ğŸ¯ <strong>CSS specificity:</strong> Multiple selectors with different priorities</li>
                    <li>ğŸ’» <strong>Computed fallback:</strong> When direct access is blocked</li>
                </ul>
                <div class="status testing">Click me to test CSS detection! ğŸ”</div>
            </div>
            
            <div class="test-element">
                <i class="fas fa-cog icon-element"></i>
                <strong>Secondary Test Element:</strong>
                <ul>
                    <li>âœ… Tests CSS rule grouping</li>
                    <li>âœ… Tests inherited styles detection</li>
                    <li>âœ… Tests computed styles priority</li>
                    <li>âœ… Tests cross-origin graceful handling</li>
                </ul>
                <div class="status info">Secondary test target ğŸ¯</div>
            </div>
            
            <div id="results" style="display: none;">
                <h3>ğŸ¯ Production Test Results:</h3>
                <ul>
                    <li>âœ… <strong>Inspector opens</strong> without Symbol conversion errors</li>
                    <li>âœ… <strong>CSS panel displays</strong> computed styles when @imports are blocked</li>
                    <li>âœ… <strong>Property names</strong> show correctly (color, font-family, font-size, etc.)</li>
                    <li>âœ… <strong>Property values</strong> are accurate and formatted properly</li>
                    <li>âœ… <strong>Rule headers</strong> show proper element selectors</li>
                    <li>âœ… <strong>Context switching</strong> analyzes actual page elements (not inspector UI)</li>
                    <li>âœ… <strong>Cross-origin handling</strong> gracefully falls back to computed styles</li>
                    <li>âœ… <strong>@import architecture</strong> detected and handled appropriately</li>
                </ul>
                
                <div style="background: #e6f3ff; padding: 12px; border-radius: 6px; margin-top: 16px;">
                    <strong>ğŸ” Expected Console Output:</strong>
                    <br><code>ğŸ¯ CSS Analysis for: div.test-element</code>
                    <br><code>âŒ Blocked stylesheet: https://fonts.googleapis.com/...</code>
                    <br><code>âœ… Found X total rules (with/without direct stylesheet access)</code>
                </div>
            </div>
        </div>
    </div>

    <!-- Load the PRODUCTION-READY inspector with integrated fixes -->
    <script src="../../dist/open-web-inspector.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ Production CSS Architecture Test Loaded');
            console.log('');
            console.log('ğŸ“‹ Testing Scenario:');
            console.log('   ğŸŒ main.css â†’ @import Google Fonts (cross-origin)');
            console.log('   ğŸ“ main.css â†’ @import local components (layout, hero, buttons, test-elements)');
            console.log('   ğŸ¨ Direct CDN link â†’ Font Awesome (cross-origin)');
            console.log('   ğŸ¯ Complex selectors â†’ .test-element.interactive.highlighted');
            console.log('   ğŸ’» Computed fallback â†’ When stylesheets are blocked');
            console.log('');
            console.log('ğŸš€ This exactly replicates the production website architecture!');
            console.log('ğŸ“ Click on test elements to verify CSS detection works perfectly.');
            console.log('');
            
            // Enable inspector automatically
            if (typeof OpenWebInspector !== 'undefined') {
                OpenWebInspector.enable();
                
                // Show results section
                document.getElementById('results').style.display = 'block';
                
                console.log('âœ… Open Web Inspector enabled with production CSS fixes!');
            } else {
                console.error('âŒ Open Web Inspector not found!');
            }
        });
        
        // Add click handlers for status updates
        document.querySelectorAll('.status').forEach(status => {
            status.addEventListener('click', function() {
                this.textContent = this.textContent.includes('Click me') 
                    ? 'CSS Detection Active! ğŸ‰' 
                    : this.textContent;
            });
        });
    </script>
</body>
</html>
